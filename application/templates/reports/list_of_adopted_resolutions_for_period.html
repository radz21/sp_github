<div class="container">
	<div class="colfull" style="padding: 30px;" id="print_list_of_adopted_resolutions_for_period">
		<div class="colfull fl">
			<div class="col20">
				<div>
					<img onerror="this.src='/../static/icon/photo_blank.png'" id="img_report_list_adopted_reso_city_logo" src="static/icon/your_logo.png" style="height: 100px;width: 100px;">
				</div>
			</div>

			<div class="col60" style="position: relative;top: -100px">
				<div style="width: 60%;margin: 0 auto;" align="center">
					<p style="text-align: center;">Republic of the Philippines</p>
					<p>Province of <span id="list_adpoted_reso_province"></span></p>
					<p><span id="list_adpoted_state_location"></span> of <span id="list_adpoted_reso_city_name" style="text-transform:capitalize;"></span></p>
				</div>
			</div>
			
		</div>
		<div style="margin-top: -80px">
			<div class="colfull fl" align="center">
				<p style="font-size:18px;font-weight: bolder;">
					List of Adopted Resolution
				</p>

				<p><span style="font-weight:700;" id="reports_total_resolutions"></span>&nbsp;Total resolutions</p>
			</div>
			<div class="colfull fl">
				<div class="center_div">
					<div class="col40">
						<p id="adopted_res_option_print">for the period of&nbsp;<span id="inp_print_res_option"></span></p>
					</div>
					<div class="col60">
						<p><span id="inp_print_res_filter"></span></p>
					</div>
				</div>
			</div>
			<div class="colfull" style="margin-top: 50px;">
				<table id="tbl_list_adopted_resolution" class="colfull table_report table" border="1">
					<colgroup>
						<col style="width:4px">
						<col style="width:8px">
						<col style="width:6px">
						<col style="width:3px">
					</colgroup>
					<thead>
						<th>Resolution #</th>
						<th>Title of Resolution</th>
						<th>Author/Co-Author/Sponsor</th>
						<th>Date Enacted</th>
					</thead>
				</table>
			</div>
			<div class="colfull" style="margin-top: 30px;">
				<div class="col50">
					<div class="col30">
						<p style="font-size: 15px;">Prepared by:</p>
					</div>
					<div class="col20">
						<p style="border-bottom: 1px solid black;width: 250px!important" contenteditable="true"></p>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div id="div_file_modal" class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content form-control">
            <div class="modal-header">
                <h5 class="modal-title">Files</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="viewerContainer"></div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
	$(document).ready(function(){

		var form_id='#form_list_adopted_res'
		 $(form_id).submit(function(e){
		 	var form_save = $(form_id).serializeObject();
	        e.preventDefault();

	        getbyId('reports_total_resolutions').innerHTML = 0
	        sendDataWithCallback('/get_adopted_resolution_by_period',form_save,function(res){
	        	if(res){
	        		if(res.length>0){
	        			const fromDate = formatReadableDate(getbyId('adopted_ord_from').value);
						const toDate = formatReadableDate(getbyId('adopted_ord_to').value);

						getbyId('inp_print_res_option').innerHTML = `${fromDate} - ${toDate}`;


						var categoryText = $('#category_adopted_res_report option:selected').text();
						var categoryValue = $('#category_adopted_res_report').val();

						var authorText = $('#author_adopted_res_report option:selected').text();
						var authorValue = $('#author_adopted_res_report').val();

						let filterParts = [];

						if (isValidSelection(categoryText, categoryValue)) {
						    filterParts.push(categoryText);
						}
						if (isValidSelection(authorText, authorValue)) {
						    filterParts.push(authorText);
						}

						if (filterParts.length > 0) {
						    getbyId('inp_print_res_filter').innerHTML = `Filter by ${filterParts.join(' and ')}`;
						} else {
						    getbyId('inp_print_res_filter').innerHTML = ""; // or "No filters selected"
						}



	        			getbyId('reports_total_resolutions').innerHTML = numberWithCommas_no_decimal(res.length)
	        		}else{
	        			topRightAlert(`No data result`)
	        		}
        		
	                if ($.fn.DataTable.isDataTable('#tbl_list_adopted_resolution')) {
	                    $('#tbl_list_adopted_resolution').DataTable().destroy();
	                }

	                var table=$('#tbl_list_adopted_resolution').DataTable({
	                    data:res,
	                     columns: [
	                        {data:"resolution_number", "render": function (data, type, row)
	                        	{
	                        		if(row.path){
	                        			return `<a href='/static/uploads/${row.path}' target='_blank'>
	                        			${row.resolution_number}</a>`
	                        		}else{
	                        			return row.resolution_number
	                        		}
	                        		
	                        	}
	                        },
	                        {data:"title"},
	                        {data:"people"},
	                        {data:"date_enacted"}
	                    ],
	                    responsive: true,
	                    dom: 'ftipr',
	                    paging:false,
	                    searching:false,
	                    "bInfo": false,
	                    order: [[3, 'asc']],
	                    "showNEntries" : false
	                }); 
	            }
			})
	    })	

		getDataWithCallback('/get_info',function(res){
			$('#author_adopted_res_report').append(`<option value="" disabled selected> ${'--SELECT--'} </option>`); 
            for(var x=0; x<res.length; x++){
                $('#author_adopted_res_report').append(`<option value="${res[x]['info_id']}"> ${res[x]['fullname']} </option>`); 
            }
            
            $('#author_adopted_res_report').trigger("chosen:updated")
		})

		getDataWithCallback('/get_category',function(res){
			$('#category_adopted_res_report').append(`<option value="" disabled selected> ${'--SELECT--'} </option>`); 
            for(var x=0; x<res.length; x++){
                $('#category_adopted_res_report').append(`<option value="${res[x]['category_id']}"> ${res[x]['title']} </option>`); 
            }
            
            $('#category_adopted_res_report').trigger("chosen:updated")
		})

	})

	function open_file_modals(elem){
		var tr = $(elem).closest('tr')
		var dataArr = $('#tbl_list_adopted_resolution').DataTable().row(tr).data();

		console.log(dataArr, "?>?>?>")

		console.log(dataArr.path)

		// $('#div_file_modal').modal('show')
	}
</script>