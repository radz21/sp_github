<div class="colfull">
	<form id="form_committee_resolution">
		<div class="colfull">
			<input type="hidden" id="h_committee_resolution_id" value="0">
			<input type="hidden" id="h_resolution_id_main">
			<p>Progress of Ordinance/Action Taken</p>
			<select id="sel_progress_action_taken_res" class="form-control">
				<option value="1" disabled selected>--SELECT</option>
				<option value="2">2nd Reading Ordinance</option>
				<option value="3">3rd Reading Ordinance</option>
				<option value="4">3rd Reading Rule Excemption</option>
				<option value="5">For mayors Approval</option>
				<option value="6">Archive Ordinance</option>
			</select>
			<div class="panel panel-primary" style="margin-top: 50px;">
				<div class="panel-heading">Upload Committee Report </div>
				<div class="panel-body">
					<div class="colful">
						<input type="file" id="committee_resolution_attach" name="committee_resolution_attach" multiple>
						<table id="tbl_committee_resolution_file" class="table" style="width: 100%">
							<thead>
								<th>Filename</th>
								<th>Action</th>
							</thead>
						</table>
					</div>
				</div>
			</div>

			<div class="panel panel-primary">
				<div class="panel-heading">Upload Committee Minutes</div>
				<div class="panel-body">
					<div class="colful" >
						<input type="file" id="committee_resolution_minutes" name="committee_resolution_minutes">
						<table id="tbl_committee_resolution_minutes_file" class="table" style="width: 100%!important">
							<thead>
								<th>Filename</th>
								<th>Action</th>
							</thead>
						</table>
					</div>
				</div>
			</div>

			<!-- <p>ACTION TAKEN</p>
			<select id="sel_committee_resolution_action_taken">
				<option value="" disabled selected>--SELECT</option>
				<option>PENDING</option>
				<option>APPROVED</option>
				<option>REJECTED</option>
			</select> -->

		</div>
		<div class="colfull" align="center" style="margin-top: 55px;">
			<button class="btn btn-success">Submit</button>
		</div>
	</form>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		var form_id='#form_committee_resolution'
		 $(form_id).submit(function(e){
	        e.preventDefault();

	        upload_committee_resolution()
	    })
	})

	function upload_committee_resolution(){
		var mydata = new FormData();

		mydata.append('resolution_id', getbyId('h_committee_resolution_id').value)
		mydata.append('resolution_id_main', getbyId('h_resolution_id_main').value)
		
		mydata.append('status', getbyId('sel_progress_action_taken_res').value)
		// mydata.append('action_taken', getbyId('sel_committee_resolution_action_taken').value)

		mydata.append('committee_id', getbyId('h_committee_id').value)

		jQuery.each($("#committee_resolution_attach")[0].files, function(i, file) {
	        mydata.append('file_attach['+i+']', file);
	    })

	    jQuery.each($("#committee_resolution_minutes")[0].files, function(i, file) {
	        mydata.append('file_minutes['+i+']', file);
	    })

	    swal.fire({
			title: "Are you sure want to save?",
			text: "Click ok to continue",
			type: "info",
			showCancelButton: true,
			showLoaderOnConfirm: true,
			preConfirm: () => {
				return fetch(console.log("log"))
				.then(
					$.ajax({
				        type: 'POST',
				        url: "/save_committee_resolution",
				        contentType:false,
				        processData:false,
				        cache: false,
				        data:mydata,
				        beforeSend: function() {
					       console.log(mydata)
					    },
				        success: function(res) {
				        	getbyId('form_committee_resolution').reset()
				        	var data={
			            		committee_id:getbyId('h_committee_id').value
			            	}
				        	load_committee_ordinance_attach_minutes(data)
				        	$('#div_committee_res_modal').modal('toggle');
							saved(res)
				        },
				        error: function() {
				            error_in_saving("error occured in sending to");
				        }
				    })
				)
				.catch(() => {
				    Swal.fire({
				      icon: 'error',
				      title: 'Error occured'
				    })
				})
			}
		})

	}
</script>